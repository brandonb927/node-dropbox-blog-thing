<div class="post-wrapper">
  <article class="post-article" itemprop="blogPosts" itemscope itemtype="http://schema.org/BlogPosting">
    <h2 class="post-title" itemprop="name headline">{{title}}</h2>
    {{#if post.isPage}}
    <div class="post-meta">
      <div class="meta-left">
        <p>
          Posted by
          <span itemprop="author" itemscope itemptype="http://schema.org/Person">
            {{#if site.social.googleplus}}
            <a href="{{site.social.googleplus}}?rel=author" target="_blank">
              <span itemprop="name">{{site.author.name}}</span>
            </a>
            {{else}}
            <span itemprop="name">{{site.author.name}}</span>
            {{/if}}
          </span>
          on <time datetime="{{dateObj}}" itemprop="datePublished">{{date}}</time>
        </p>
      </div>
      {{#if this.tags}}
      <div class="meta-right">
        <p>
          <span class="meta-label">Tags: </span>
          <span class="meta-tags">
          {{#each this.tags}}
            <a href="/tag/{{this}}">{{this}}</a>
          {{/each}}
          </span>
        </p>
      </div>
      {{/if}}
    </div>
    {{/if}}

    <div class="post-content" itemprop="text">
      {{content}}
    </div>
  </article>

  {{#if isPage}}{{else}}
  {{#if disqus.shortname}}
  <hr />
  <div class="post-comments">
    {{!-- <div class="text-center">
      <button class="button show-comments">Load Comments</button>
    </div> --}}
    <div id="disqus_thread" data-disqus-shortname="{{disqus.shortname}}" data-disqus-url="{{url}}"></div>
  </div>

  <script>
  $(document).ready(function () {
    var disqus_div = $("#disqus_thread");
    if (disqus_div.size() > 0 ) {
      var ds_loaded   = false;
      var top         = disqus_div.offset().top;
      var disqus_data = disqus_div.data();

      var check = function () {
        if ( !ds_loaded && $(window).scrollTop() + $(window).height() > top ) {
          ds_loaded = true;
          for (var key in disqus_data) {
            if (key.substr(0,6) == 'disqus') {
              window['disqus_' + key.replace('disqus','').toLowerCase()] = disqus_data[key];
            }
          }
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + window.disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }
      };

      $(window).scroll(check);
      check();
    }

    // $('.show-comments').on('click', function () {
    //   {{#if googleAnalytics}}
    //   ga('send', 'event', 'button', 'click', 'show-comments');
    //   {{/if}}

    //   $(this).fadeOut('fast');

    //   // Delay the script loading so the button fades out
    //   // before the disqus loader takes it's place
    //   setTimeout(function () {
    //     $.ajax({
    //       type      : "GET",
    //       url       : "http://{{disqus.shortname}}.disqus.com/embed.js",
    //       dataType  : "script",
    //       cache     : true
    //     })
    //   }, 200);

    // });
  });
  </script>
  {{/if}}
  {{/if}}
</div>
