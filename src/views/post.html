{% extends 'layout.html' %}

{% block body %}

<div class="post-wrapper">
  <article class="post-article" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
    <h2 class="post-title" itemprop="name headline">{{post.title}}</h2>

    {% if not post.isPage %}
    <div class="post-meta">
      <div class="meta-left">
        <p>
          Posted by
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            {% if site.social.googleplus %}
            <a href="{{site.social.googleplus}}?rel=author" target="_blank" itemprop="url">
              <span itemprop="name">{{site.author.name}}</span>
            </a>
            {% else %}
            <span itemprop="name">{{site.author.name}}</span>
            {% endif %}
          </span>
          on <time datetime="{{post.dateObj}}" itemprop="datePublished">{{post.date}}</time>
        </p>
      </div>
      {% if post.tags|length %}
      <div class="meta-right">
        <p>
          <span class="meta-label">Tags: </span>
          <span class="meta-tags">
          {% for tag in post.tags %}
            <a href="/tag/{{tag}}">{{tag}}</a>
          {% endfor %}
          </span>
        </p>
      </div>
      {% endif %}
    </div>
    {% endif %}

    <div class="post-content" itemprop="text">
      {{post.content}}
    </div>
  </article>

  {% if not post.isPage %}
  {% if disqus.shortname %}
  <hr />
  <div class="post-comments">
    <div class="text-center">
      <button class="button show-comments">Load Comments</button>
    </div>
    <div id="disqus_thread" data-disqus-shortname="{{disqus.shortname}}" data-disqus-url="{{post.url}}"></div>
    <script>
      var commentsButton = document.querySelector('.show-comments');
      commentsButton.addEventListener('click', function () {
        {% if googleAnalytics %}
        ga('send', 'event', 'button', 'click', 'show-comments');
        {% endif %}

        this.style.display = 'none';

        // Delay the script loading so the button fades out
        // before the disqus loader takes it's place
        setTimeout(function () {
          var script = document.createElement('script');
          script.setAttribute('type','text/javascript');
          script.setAttribute('src', '//{{disqus.shortname}}.disqus.com/embed.js');
          document.getElementsByTagName('head')[0].appendChild(script);
        }, 200);
      });
    </script>
  </div>
  {% endif %}
  {% endif %}
</div>

{% endblock %}
